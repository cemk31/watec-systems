<ion-header>
  <ion-toolbar>
    <ion-title>Bestellungen</ion-title>
  </ion-toolbar>
</ion-header>


<ion-content>
    <!-- This is your Search Bar -->
<ion-searchbar placeholder="Suche..." [(ngModel)]="filterTerm" animated="true"></ion-searchbar>

<!-- This is your List -->
<!-- <ion-list>
  <ion-item *ngFor="let order of filteredItems">
    {{ order.name }}
  </ion-item>
</ion-list> -->

<ion-grid>
  <ion-row style="background-color:green;">
    <ion-col *ngFor="let key of keysToDisplay" style="padding:10px;">
      <strong>{{key}}</strong>
    </ion-col>

  </ion-row>  
  <div>
    <div *ngFor="let item of orders | filter:filterTerm; let i = index">
      <ion-row>
        <ion-col *ngFor="let key of keysToDisplay " style="padding:10px;">
          {{item[key]}}
        </ion-col>
        <ion-col>
          <ion-button *ngIf="item.status.length > 0 || item.Planned.length > 0 || item.Received.length > 0 || item.Postponed.length > 0
            || item.Cancelled.length > 0 || item.NotPossible.length > 0 || item.ClosedContractPartner.length > 0" (click)="item.showDetails = !item.showDetails">mehr</ion-button>  
        </ion-col>
      </ion-row>
      <div *ngIf="item.showDetails">
        <div *ngIf="item.status.length > 0" style="#background-color: #00008B; padding:10px;">
          <h3>Status</h3>
          <ion-list *ngFor="let status of item.status; let i = index" color="primary">
            <ion-item>
              <ion-label>Statustype:</ion-label>
              <ion-input type="text" value="{{status.type}}"></ion-input>
            </ion-item>
            <ion-item>
              <ion-label>Statustype:</ion-label>
              <ion-input type="date" value="{{status.createdAt}}"></ion-input>
            </ion-item>
          </ion-list>
        </div>

        <h3>Aktivitätenprotokoll</h3>
        <ion-button (click)="showForm = true">+ Hinzufügen</ion-button>
        
        <ion-grid>
          <ion-row>
            <ion-col>Select</ion-col>
            <ion-col>ID</ion-col>
            <ion-col>Beschreibung</ion-col>
            <ion-col>Aktueller Status</ion-col>
            <ion-col>contactAttemptOn</ion-col>
            <ion-col>contactPersonCustomer</ion-col>
            <ion-col>agentCP</ion-col>
            <ion-col>result</ion-col>
            <ion-col>remark</ion-col>
          </ion-row>

          <!-- for display -->
          <ion-row>
            <ion-col>Select</ion-col>
            <ion-col>ID</ion-col>
            <ion-col>Beschreibung</ion-col>
            <ion-col>Aktueller Status</ion-col>
            <ion-col>contactAttemptOn</ion-col>
            <ion-col>contactPersonCustomer</ion-col>
            <ion-col>agentCP</ion-col>
            <ion-col>result</ion-col>
            <ion-col>remark</ion-col>
          </ion-row>

        </ion-grid>
        
        <ion-button *ngIf="showForm" (click)="addActivity()">Submit</ion-button>

        
        <ion-row *ngFor="let s of statusTypes" style="padding:10px;">
          <div *ngIf="s.items.length > 0">
            <h2>{{s.title}}</h2>
            <div *ngFor="let item of s.items; let i = index">
              <p *ngFor="let key of getItemKeys(item)"><strong>{{key}}:</strong> {{item[key]}}</p>
            </div>
          </div>
        </ion-row>

        <ion-content>
    <ion-grid>
        <ion-row>
            <ion-col><strong>ID</strong></ion-col>
            <ion-col><strong>Request ID</strong></ion-col>
            <ion-col><strong>Order ID</strong></ion-col>
            <ion-col><strong>Status Type</strong></ion-col>
            <ion-col><strong>Set On</strong></ion-col>
            <!-- Add more headers as needed -->
        </ion-row>

        <!-- Repeat this for each category (Postponed, Cancelled, etc.) -->
        <ion-row *ngFor="let item of items.Postponed">
            <ion-col>{{item.id}}</ion-col>
            <ion-col>{{item.requestId}}</ion-col>
            <ion-col>{{item.orderId}}</ion-col>
            <ion-col>{{item.statusType}}</ion-col>
            <ion-col>{{item.setOn}}</ion-col>
            <!-- Add more columns as needed -->
        </ion-row>
        <!-- End repeat -->

    </ion-grid>
</ion-content>

        <ion-row *ngIf="item.Received.length > 0" style="padding:10px;">
          <div>
            <ion-toolbar color="primary">
              <ion-title>Received</ion-title>
            </ion-toolbar>
            <ion-list *ngFor="let received of item.Received; let i = index">
              <ion-item>
                <ion-label><strong>Order ID:</strong></ion-label> 
                <ion-note slot="end">{{received.orderId}}</ion-note>
              </ion-item> 
              <ion-item>
                <ion-label><strong>Status Type:</strong></ion-label>
                <ion-note slot="end">{{received.orderstatusType}}</ion-note>
              </ion-item>
              <ion-item>
                <ion-label><strong>Request ID:</strong></ion-label>
                <ion-note slot="end">{{received.requestId}}</ion-note>
              </ion-item>
              <ion-item>
                <ion-label><strong>Set On:</strong></ion-label>
                <ion-note slot="end">{{received.setOn}}</ion-note>
              </ion-item>
            </ion-list>        
          </div> 
        </ion-row>   

  <ion-row *ngIf="item.Planned.length > 0" style="padding:10px;">
    <div>
      <ion-toolbar color="primary">
        <ion-title>Planned</ion-title>
      </ion-toolbar>
      <ion-list *ngFor="let planned of item.Planned; let i = index">
        <ion-item>
          <ion-label><strong>Order ID:</strong></ion-label> 
          <ion-note slot="end">{{planned.orderId}}</ion-note>
        </ion-item> 
        <ion-item>
          <ion-label><strong>Status Type:</strong></ion-label>
          <ion-note slot="end">{{planned.orderstatusType}}</ion-note>
        </ion-item>
        <ion-item>
          <ion-label><strong>Set On:</strong></ion-label>
          <ion-note slot="end">{{planned.setOn}}</ion-note>
        </ion-item>
        <ion-item>
          <ion-label><strong>Detailed Schedule Date:</strong></ion-label>
          <ion-note slot="end">{{planned.detailedScheduleDate}}</ion-note>
        </ion-item>
        <ion-item>
          <ion-label><strong>Detailed Schedule Time From:</strong></ion-label>
          <ion-note slot="end">{{planned.detailedScheduleTimeFrom}}</ion-note>
        </ion-item>
        <ion-item>
          <ion-label><strong>Detailed Schedule Time To:</strong></ion-label>
          <ion-note slot="end">{{planned.detailedScheduleTimeTo}}</ion-note>
        </ion-item>
        <ion-item>
          <ion-label><strong>Detailed Schedule Delay Reason:</strong></ion-label>
          <ion-note slot="end">{{planned.detailedScheduleDelayReason}}</ion-note>
        </ion-item>
        <ion-item>
          <ion-label><strong>Request ID:</strong></ion-label>
          <ion-note slot="end">{{planned.requestId}}</ion-note>
        </ion-item>
      </ion-list>        
    </div> 
  </ion-row>

      
          <ion-row *ngIf="item.Postponed.length > 0" style="padding:10px;">
            <div>
              <h2>Postponed</h2>
              <div *ngFor="let postponed of item.Postponed; let i = index">
                <p><strong>Order ID:</strong> {{postponed.orderId}}</p> 
                <p><strong>Status Type:</strong> {{postponed.orderstatusType}}</p> 
                <p><strong>setOn:</strong> {{postponed.setOn}}</p>
                <p><strong>detailedScheduleDate:</strong> {{postponed.detailedScheduleDate}}</p>
                <p><strong>detailedScheduleTimeFrom:</strong> {{postponed.detailedScheduleTimeFrom}}</p>
                <p><strong>detailedScheduleTimeTo:</strong> {{postponed.detailedScheduleTimeTo}}</p>
                <p><strong>detailedScheduleDelayReason:</strong> {{postponed.detailedScheduleDelayReason}}</p>
                <p><strong>requestId:</strong> {{postponed.requestId}}</p>
              </div>        
            </div> 
          </ion-row>
          
          <ion-row *ngIf="item.Cancelled.length > 0" style="padding:10px;">
            <div>
              <h2>Cancelled</h2>
              <div *ngFor="let cancelled of item.Cancelled; let i = index">
                <p><strong>id:</strong> {{cancelled.id}}</p> 
                <p><strong>requestId:</strong> {{cancelled.requestId}}</p> 
                <p><strong>orderId:</strong> {{cancelled.orderId}}</p>
                <p><strong>statusType:</strong> {{cancelled.statusType}}</p>
                <p><strong>setOn:</strong> {{cancelled.setOn}}</p>
                <p><strong>cancellationReason:</strong> {{cancelled.cancellationReason}}</p>
              </div>        
            </div> 
          </ion-row>
      
          <ion-row *ngIf="item.Rejected.length > 0" style="padding:10px;">
            <div>
              <h2>Rejected</h2>
              <ion-button>Neu Hinzufügen</ion-button>
              <div *ngFor="let rejected of item.Rejected; let i = index">
                <p><strong>id:</strong> {{rejected.id}}</p> 
                <p><strong>requestId:</strong> {{rejected.requestId}}</p> 
                <p><strong>orderId:</strong> {{rejected.orderId}}</p>
                <p><strong>statusType:</strong> {{rejected.statusType}}</p>
                <p><strong>reason:</strong> {{rejected.reason}}</p>
                <p><strong>reasonText:</strong> {{rejected.reasonText}}</p>
              </div>        
            </div> 
          </ion-row>
      
          <ion-row *ngIf="item.ClosedContractPartner.length > 0" style="padding:10px;">
            <div>
              <h2>ClosedContractPartner</h2>
              <div *ngFor="let closedContractPartner of item.ClosedContractPartner; let i = index">
                <p><strong>id:</strong> {{closedContractPartner.id}}</p> 
                <p><strong>requestId:</strong> {{closedContractPartner.requestId}}</p> 
                <p><strong>orderId:</strong> {{closedContractPartner.orderId}}</p>
                <p><strong>orderstatusType:</strong> {{closedContractPartner.orderstatusType}}</p>
                <p><strong>setOn:</strong> {{closedContractPartner.setOn}}</p>
                <p><strong>deficiencyDescription:</strong> {{closedContractPartner.deficiencyDescription}}</p>
                <p><strong>registrationHealthAuthoritiesOn:</strong> {{closedContractPartner.registrationHealthAuthoritiesOn}}</p>
                <p><strong>extraordinaryExpenditureReason:</strong> {{closedContractPartner.extraordinaryExpenditureReason}}</p>
              </div>        
            </div> 
          </ion-row>
      
          <ion-row *ngIf="item.NotPossible.length > 0" style="padding:10px;">
            <div>
              <h2>NotPossible</h2>
              <div *ngFor="let notPossible of item.NotPossible; let i = index">
                <p><strong>id:</strong> {{notPossible.id}}</p> 
                <p><strong>requestId:</strong> {{notPossible.requestId}}</p> 
                <p><strong>orderId:</strong> {{notPossible.orderId}}</p>
                <p><strong>statusType:</strong> {{notPossible.orderstatusType}}</p>
                <p><strong>setOn:</strong> {{notPossible.setOn}}</p>
              </div>        
            </div> 
          </ion-row>
      </div>
      </div>
  </div>  
  </ion-grid>
</ion-content>
